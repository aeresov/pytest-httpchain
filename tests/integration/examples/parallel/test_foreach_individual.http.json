{
  "description": "Test parallel foreach with IndividualParameter - saves last value",
  "stages": [
    {
      "name": "parallel_foreach_individual",
      "fixtures": ["server"],
      "parallel": {
        "foreach": [
          {"individual": {"iteration_value": [1, 2, 3, 4, 5]}}
        ],
        "max_concurrency": 3
      },
      "request": {
        "url": "{{ server }}/ok"
      },
      "response": [
        {
          "verify": {
            "status": 200
          }
        },
        {
          "save": {
            "substitutions": [
              {
                "vars": {
                  "last_value": "{{ iteration_value }}"
                }
              }
            ]
          }
        }
      ]
    },
    {
      "name": "verify_last_wins",
      "fixtures": ["server"],
      "request": {
        "url": "{{ server }}/ok"
      },
      "response": [
        {
          "verify": {
            "status": 200,
            "expressions": [
              "{{ last_value == 5 }}"
            ]
          }
        }
      ]
    }
  ]
}
